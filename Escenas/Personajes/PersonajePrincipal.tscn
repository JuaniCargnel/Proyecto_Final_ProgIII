[gd_scene load_steps=8 format=3 uid="uid://dnuefdw5cng6h"]

[ext_resource type="Script" path="res://Scripts/personajePrincipal.gd" id="1_kresr"]
[ext_resource type="Shader" path="res://Shaders/dmg.gdshader" id="2_0br16"]
[ext_resource type="SpriteFrames" uid="uid://cs5af0g0oty7g" path="res://Assets/Jugador/PersonajePrincipalAnimation.tres" id="3_nta07"]

[sub_resource type="ShaderMaterial" id="ShaderMaterial_6pkm1"]
shader = ExtResource("2_0br16")
shader_parameter/flicker_speed = 10.0
shader_parameter/flicker_amount = 0.5
shader_parameter/flicker_enabled = false

[sub_resource type="RectangleShape2D" id="RectangleShape2D_vrb56"]
size = Vector2(14, 9.75)

[sub_resource type="RectangleShape2D" id="RectangleShape2D_hpf4g"]
size = Vector2(6, 6.75)

[sub_resource type="RectangleShape2D" id="RectangleShape2D_7m76b"]
size = Vector2(14, 10)

[node name="PersonajePrincipal" type="CharacterBody2D" groups=["player"]]
z_index = 3
motion_mode = 1
script = ExtResource("1_kresr")

[node name="Sprite" type="AnimatedSprite2D" parent="." groups=["sprites"]]
material = SubResource("ShaderMaterial_6pkm1")
sprite_frames = ExtResource("3_nta07")
animation = &"idle"
metadata/SombraMark = Vector2(0, 0)

[node name="Camera2D" type="Camera2D" parent="."]
zoom = Vector2(2, 2)
limit_left = 0
limit_top = 0
limit_right = 1400
limit_bottom = 1080

[node name="Hitbox" type="CollisionShape2D" parent="."]
position = Vector2(-1, 11)
shape = SubResource("RectangleShape2D_vrb56")

[node name="SombraMark" type="Marker2D" parent="."]
position = Vector2(-14.5, 24.5)

[node name="HittingArea" type="Area2D" parent="."]
collision_layer = 3
collision_mask = 3

[node name="HitboxHit" type="CollisionShape2D" parent="HittingArea"]
position = Vector2(12, -1)
scale = Vector2(2, 0.5)
shape = SubResource("RectangleShape2D_hpf4g")
disabled = true

[node name="DmgArea" type="Area2D" parent="." groups=["playerDmg"]]

[node name="CollisionShape2D" type="CollisionShape2D" parent="DmgArea"]
position = Vector2(-1, 11)
shape = SubResource("RectangleShape2D_7m76b")

[node name="Timers" type="Node" parent="."]

[node name="Roll" type="Timer" parent="Timers"]
wait_time = 0.5
one_shot = true

[node name="RollTimer" type="Timer" parent="Timers"]
wait_time = 2.0
one_shot = true

[node name="HitB" type="Timer" parent="Timers"]
wait_time = 0.45
one_shot = true

[node name="HitBTimer" type="Timer" parent="Timers"]
wait_time = 0.5
one_shot = true

[node name="HitA" type="Timer" parent="Timers"]
wait_time = 0.4
one_shot = true

[node name="HitATimer" type="Timer" parent="Timers"]
wait_time = 0.2
one_shot = true

[node name="Death" type="Timer" parent="Timers"]
wait_time = 2.0

[node name="SwordTimer" type="Timer" parent="Timers"]
wait_time = 15.0
one_shot = true

[connection signal="body_entered" from="HittingArea" to="." method="_on_hitting_area_body_entered"]
[connection signal="body_exited" from="HittingArea" to="." method="_on_hitting_area_body_exited"]
[connection signal="timeout" from="Timers/Roll" to="." method="_on_roll_timeout"]
[connection signal="timeout" from="Timers/RollTimer" to="." method="_on_roll_timer_timeout"]
[connection signal="timeout" from="Timers/HitB" to="." method="_on_hit_b_timeout"]
[connection signal="timeout" from="Timers/HitBTimer" to="." method="_on_hit_b_timer_timeout"]
[connection signal="timeout" from="Timers/HitA" to="." method="_on_hit_a_timeout"]
[connection signal="timeout" from="Timers/HitATimer" to="." method="_on_hit_a_timer_timeout"]
[connection signal="timeout" from="Timers/Death" to="." method="_on_death_timeout"]
[connection signal="timeout" from="Timers/SwordTimer" to="." method="_on_sword_timer_timeout"]
